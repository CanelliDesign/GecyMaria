<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gecy Maria: Autobiografia</title>
    <!-- Fontes (com fallback se offline) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&family=Inter:wght@400;700&family=Great+Vibes&display=swap" rel="stylesheet">
    
    <style>
        /* --- Reset & Variáveis --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        :root {
            --bg-color: #f0eadd;
            --paper-color: #FDFBF8;
            --text-color: #44403c; /* Stone 700 */
            --accent-color: #7c2d12; /* Orange 900 */
            --accent-light: #e3dac9;
        }

        body {
            font-family: 'Lora', 'Georgia', serif; /* Fallback para serif se offline */
            background-color: var(--bg-color);
            background-image: radial-gradient(#d6cbb3 1px, transparent 1px);
            background-size: 20px 20px;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            -webkit-font-smoothing: antialiased;
            touch-action: pan-y;
            user-select: none;
            -webkit-user-select: none;
            color: var(--text-color);
        }

        /* --- Tipografia --- */
        h1, h2, h3 { font-weight: normal; }
        
        .font-fancy {
            font-family: 'Great Vibes', 'Brush Script MT', cursive; /* Fallback */
        }
        
        .font-sans {
            font-family: 'Inter', 'Helvetica', sans-serif;
        }

        /* --- Cena e Livro --- */
        .scene {
            width: 100%;
            height: 85vh;
            max-width: 1000px;
            perspective: 1500px;
            position: relative;
            margin: 0 auto;
        }

        .book {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
        }

        /* --- Páginas --- */
        .page {
            position: absolute;
            width: 50%;
            height: 100%;
            top: 0;
            right: 0;
            transform-origin: left center;
            transform-style: preserve-3d;
            background-color: var(--paper-color);
            border-radius: 0 10px 10px 0;
            box-shadow: inset 5px 0 10px rgba(0,0,0,0.02), -2px 0 8px rgba(0,0,0,0.1);
            cursor: grab;
            will-change: transform;
            display: none; /* Padrão invisível */
        }
        
        .page.active-page { display: block; }
        .page.grabbing { cursor: grabbing; }
        .page-transition { transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1); }

        /* Frente da Página */
        .page-front {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            padding: 40px;
            overflow: hidden;
            background-color: var(--paper-color);
            background-image: linear-gradient(to right, #e8e0d0 0%, #FDFBF8 5%, #FDFBF8 95%, #e8e0d0 100%);
            z-index: 2;
        }

        /* Verso da Página */
        .page-back {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            transform: rotateY(180deg);
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            background-image: linear-gradient(to left, #e8e0d0 0%, #FDFBF8 5%, #FDFBF8 95%, #e8e0d0 100%);
            border-radius: 10px 0 0 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f7f3e8;
            pointer-events: none;
            z-index: 1;
        }

        /* Sombras */
        .page-fold-shadow {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 10;
            transition: opacity 0.2s;
        }

        /* Conteúdo de Texto */
        .content-scroll {
            height: 100%;
            overflow-y: auto;
            padding-right: 15px;
            -webkit-overflow-scrolling: touch;
            text-align: justify;
            line-height: 1.6;
            font-size: 1.125rem; /* 18px */
        }
        /* Títulos */
        .story-title {
            font-size: 2rem;
            color: #7c2d12;
            margin-bottom: 1.5rem;
            font-weight: bold;
            line-height: 1.2;
            text-align: left;
        }

        /* Mobile Styles */
        @media (max-width: 768px) {
            .scene { height: 80vh; perspective: 1200px; padding: 10px; }
            .page { width: 95%; right: 2.5%; border-radius: 4px 12px 12px 4px; }
            .page-back { border-radius: 12px 4px 4px 12px; }
            .page-front { padding: 25px 25px 80px 25px; }
            .story-title { font-size: 1.5rem; }
            .content-scroll { font-size: 1rem; }
        }

        /* --- Capa Personalizada (Nova) --- */
        .cover-content {
            display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; color: var(--accent-light);
            padding: 2rem;
        }
        .cover-bg {
            background-color: var(--accent-color);
            /* Borda dupla estilo livro antigo */
            border: double 6px var(--accent-light);
            box-shadow: inset 0 0 30px rgba(0,0,0,0.3);
            /* Padrão sutil */
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 2.24 5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23000000' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
        }
        .cover-title { 
            font-size: 3.5rem; margin-bottom: 0.5rem; 
            color: var(--accent-light); 
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5); 
        }
        .cover-subtitle { 
            font-size: 1.25rem; letter-spacing: 0.15em; text-transform: uppercase; 
            margin-bottom: 2rem; font-weight: 400; font-family: 'Inter', sans-serif;
            color: rgba(255, 255, 255, 0.9);
        }
        /* Novo elemento ornamental */
        .cover-ornament {
            margin: 1rem 0 1.5rem 0;
            color: var(--accent-light);
            opacity: 0.9;
        }
        
        @media (min-width: 768px) {
            .cover-title { font-size: 4.5rem; }
            .cover-content { padding: 3rem; }
        }

        /* --- Índice --- */
        .index-list { list-style: none; padding-bottom: 20px; }
        .index-item {
            padding: 12px 0;
            border-bottom: 1px solid #e5e7eb;
            display: flex; justify-content: space-between; align-items: center;
            cursor: pointer;
            transition: color 0.2s;
        }
        .index-item:hover { color: #9a3412; }
        .index-item:active { background-color: rgba(0,0,0,0.05); }
        .page-badge { font-size: 0.75rem; background: #f5f5f4; padding: 2px 8px; border-radius: 12px; color: #78716c; font-family: sans-serif; }

        /* --- UI Elements --- */
        .page-number {
            position: absolute; bottom: 20px; width: 100%; text-align: center;
            font-size: 0.8rem; color: #888; left: 0; pointer-events: none;
            font-family: sans-serif;
        }

        /* Botões de Navegação */
        .nav-btn {
            position: fixed; top: 50%; transform: translateY(-50%);
            background: transparent; color: var(--accent-color);
            padding: 15px; border-radius: 50%; border: none;
            cursor: pointer; z-index: 200;
            display: flex; align-items: center; justify-content: center;
            opacity: 0.6; transition: all 0.2s ease;
        }
        .nav-btn:hover { opacity: 1; background: rgba(124, 45, 18, 0.05); transform: translateY(-50%) scale(1.1); }
        .btn-prev { left: 10px; }
        .btn-next { right: 10px; }
        .btn-disabled { opacity: 0 !important; pointer-events: none; }

        /* Botão Download (Material Design) */
        .btn-download {
            position: fixed; top: 20px; right: 20px; z-index: 300;
            background-color: white; color: var(--accent-color);
            width: 48px; height: 48px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15); border: none;
            cursor: pointer; transition: transform 0.2s;
        }
        .btn-download:hover { transform: scale(1.1); background-color: var(--accent-color); color: white; }
        .btn-download svg { width: 24px; height: 24px; }

        /* Barra de Progresso */
        .progress-bar {
            position: fixed; top: 0; left: 0; height: 4px;
            background: var(--accent-color); transition: width 0.3s; z-index: 300;
        }

        /* Instruções */
        .instructions {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(255,255,255,0.9); padding: 6px 16px;
            border-radius: 20px; font-size: 0.8rem; color: #666;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1); z-index: 250;
            pointer-events: none; font-family: sans-serif; white-space: nowrap;
        }

        @media (max-width: 768px) {
            .nav-btn { top: auto; bottom: 15px; transform: none; opacity: 0.9; background: rgba(255,255,255,0.8); }
            .nav-btn:hover { transform: scale(1.1); background: white; }
            .btn-prev { left: 20px; } .btn-next { right: 20px; }
            .nav-btn svg { width: 32px; height: 32px; }
            .instructions { font-size: 0.75rem; width: 90%; text-align: center; }
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #d6cbb3; border-radius: 3px; }
    </style>
</head>
<body>

    <div id="progress" class="progress-bar" style="width: 0%"></div>

    <!-- Botão de Download -->
    <button class="btn-download" onclick="downloadBook()" title="Baixar livro para ler offline">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M12 3v13.5m0 0L7.5 12m4.5 4.5L16.5 12" />
        </svg>
    </button>

    <!-- Instruções -->
    <div class="instructions">
        <span class="desktop-msg">Arraste a borda para virar</span>
        <span class="mobile-msg" style="display:none">Arraste para os lados para virar</span>
    </div>

    <!-- O Livro -->
    <div class="scene" id="scene-container">
        <div class="book" id="book">
            <!-- Páginas geradas via JS -->
        </div>
    </div>

    <!-- Controles -->
    <button id="btn-prev" class="nav-btn btn-prev btn-disabled" aria-label="Página anterior">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" width="36" height="36">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
        </svg>
    </button>
    <button id="btn-next" class="nav-btn btn-next" aria-label="Próxima página">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" width="36" height="36">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
        </svg>
    </button>

    <script>
        // Detector simples para mensagem
        if(window.innerWidth < 768) {
            document.querySelector('.desktop-msg').style.display = 'none';
            document.querySelector('.mobile-msg').style.display = 'inline';
        }

        const stories = [
            { id: 'capa', type: 'cover', title: 'Minha Vida', content: '' },
            { id: 'indice', type: 'index', title: 'Índice', content: '' },
            
            // Textos Ajustados para Linguagem Mais Leve e Menos Dogmática
            { 
                id: 'intro', 
                theme: 'inicio', 
                title: 'Neste Pequeno Livro', 
                content: `Neste pequeno livro, quero compartilhar minha história. Eu tinha apenas quatro anos quando comecei a entender o mundo ao meu redor. Meus pais moravam no interior, num lugar encantador de Minas Gerais chamado Vale Verde. Nossa casa era humilde, um ranchinho de barro coberto de sapé, mas cercado de plantas que traziam vida e cor ao nosso dia a dia.<br><br>Era um tempo diferente, onde a simplicidade ditava o ritmo. Minha memória guarda com carinho a pureza daquela infância. Vivíamos cercados pela natureza e protegidos pelo amor de nossa família. A fé era o alicerce da nossa casa, e acredito que essa união espiritual nos trazia uma alegria genuína.<br><br>Nos fundos de casa, corria um riacho de águas claras, onde alamandas amarelas se debruçavam sobre os pés de ingás, refletindo sua beleza na água. Era ali que eu gostava de ficar, sentindo a paz daquele lugar.<br><br>Meus pais faziam questão de nos reunir todas as manhãs. Cantávamos canções antigas e ouvíamos histórias de tempos bíblicos, como a coragem do rei Davi. Havia um respeito profundo entre nós, e aprendíamos desde cedo o valor da gratidão e do amor ao próximo.<br><br>Aos domingos, caminhávamos até uma capela simples à beira da estrada. Lá, com a professora tia Dulce, aprendíamos lições que levo para a vida toda: amar a família, respeitar os amigos e manter o coração limpo de mágoas.` 
            },
            
            { 
                id: 'passaros', 
                theme: 'inicio', 
                title: 'O Canto dos Pássaros e a Poeira da Estrada', 
                content: `Foi por volta de 1961. Nossa família era grande: meu irmão mais velho de 10 anos, a caçula de 2, e minha mãe prestes a trazer o sétimo filho ao mundo.<br><br>O cenário da minha infância era o sertão mineiro em sua forma mais pura: muito verde, águas cristalinas e estradas de terra vermelha que levantavam poeira ao vento. A trilha sonora dos nossos dias era o canto dos pássaros, uma orquestra natural regida pela própria natureza entre as árvores imponentes.<br><br>Minha mãe adorava nos levar para visitar as tias. Para nós, crianças, a longa caminhada não era sacrifício, era aventura. Íamos brincando pelas estradas, sem a pressa dos relógios de hoje. O perigo parecia não existir naquele mundo de inocência.<br><br>A maior emoção era ouvir, ao longe, o rangido de um carro de boi. Quando aquelas rodas enormes passavam cantando pela estrada, a gente parava só para admirar. À beira do caminho, as flores silvestres perfumavam nossa jornada até a fazenda da tia.<br><br>Chegando lá, o ritual era sagrado: lavar os pés sujos de terra e sentar-se à mesa para o café com leite e broa de fubá fresquinha. Tenho muitas saudades daquele tempo. Sei que o passado não volta, mas fecho os olhos e ainda consigo sentir o cheiro daquela tarde na fazenda.` 
            },
            
            { 
                id: 'susto', 
                theme: 'sustos', 
                title: 'Um Grande Susto', 
                content: `Certa vez, meu pai foi trabalhar na mata, no alto da serra, deixando minha mãe cuidando de nós. Brincávamos no terreiro, despreocupados, quando algo estranho aconteceu. As galinhas começaram a cacarejar desesperadas, num alvoroço fora do comum.<br><br>Mamãe correu para ver o que era e deparou-se com uma cobra enorme, de quase três metros. O medo tomou conta de nós. Corremos para nos esconder atrás da saia da mamãe, com o coração disparado, pedindo proteção aos céus.<br><br>Foi um momento de tensão, mas, felizmente, papai chegou do trabalho naquela hora exata. Ele nos acalmou, protegeu a família e resolveu a situação. Naquele dia, sentimos na pele o alívio de estarmos seguros e juntos novamente.` 
            },
            
            { 
                id: 'cura', 
                theme: 'sustos', 
                title: 'O Irmãozinho', 
                content: `Meu irmão mais novo, de quatro anos, era muito levado. Um dia, brincando perto do fogão a lenha, ele caiu para trás e bateu a cabeça. No início, mamãe achou que ele estava apenas tirando uma soneca, mas logo percebeu que ele havia desmaiado e não acordava.<br><br>O desespero tomou conta. Mamãe gritava por nosso pai, que estava longe, no alto da montanha. Incrivelmente, ele ouviu e desceu correndo. Ao ver o filho desacordado, papai o tomou nos braços e fez uma oração profunda, cheia de fé e esperança.<br><br>Para nossa alegria, meu irmãozinho abriu os olhos, recuperou a cor e voltou a sorrir. Aquele susto passou, e ele cresceu forte e saudável, para a felicidade de todos nós.` 
            },
            
            { 
                id: 'saudade', 
                theme: 'inicio', 
                title: 'Aventuras e Travessuras', 
                content: `A vida no sertão era livre, mas tinha suas regras. Certo dia, mamãe precisou sair e nos deixou um aviso sério: "Não brinquem com fogo e nem pulem a janela, é perigoso".<br><br>Mas, como toda criança curiosa, assim que ela virou as costas, a tentação da brincadeira falou mais alto. Esquecemos o aviso e fizemos nossa própria festa. O problema foi quando mamãe chegou e descobriu a travessura. Naquela época, a disciplina era rigorosa, e sabíamos que levaríamos uma bronca daquelas.<br><br>Com medo do castigo, eu e meu irmão pulamos a janela e corremos em direção ao matagal. Corremos até faltar o fôlego, parando apenas quando chegamos à beira do rio, longe dos olhos bravos da mamãe.` 
            },
            
            { 
                id: 'rio', 
                theme: 'sustos', 
                title: 'Coragem à Beira do Rio', 
                content: `Cansados da fuga, sentamos à beira do rio para descansar. A adrenalina passou e a fome bateu. Havia um pé de jenipapo carregado, mas éramos pequenos demais para alcançar os frutos. Resolvemos o problema como crianças da roça: atirando pedras até as frutas caírem. Enquanto comíamos, o silêncio da mata foi quebrado.<br><br>O mato se moveu e, de repente, surgiu uma cobra enorme. O medo nos paralisou por um instante. Estávamos sozinhos, longe de casa. Mas, em vez de correr, lembramos das histórias de coragem que ouvíamos, como a de Davi enfrentando o gigante. Aquilo nos deu uma força que nem sabíamos que tínhamos.<br><br>Enfrentamos o perigo juntos, jogando pedras para afugentar o animal, até que conseguimos nos livrar da ameaça. Passado o susto, veio a dúvida: como voltar para casa? Será que mamãe ainda estava brava?<br><br>Tivemos uma ideia de criança: "Se a gente mostrar que fomos corajosos e enfrentamos essa cobra sozinhos, a mamãe vai ficar tão impressionada que vai esquecer da bronca!". E assim fizemos. Arrastamos a cobra (que já não oferecia perigo) pelo caminho de volta.<br><br>Quando nossos pais nos viram chegando do campo puxando aquilo, o espanto foi geral. Mas o medo da bronca era infundado: ao verem que estávamos salvos de um perigo tão grande, eles só conseguiram nos abraçar e chorar de alívio. Naquele dia, a lição não foi sobre castigo, mas sobre o quanto éramos amados.` 
            },
            
            { 
                id: 'cachorro', 
                theme: 'sustos', 
                title: 'Mistérios da Noite', 
                content: `Na roça, as noites de lua cheia são claras como o dia, mas cheias de mistérios. Certa vez, nossos pais saíram e ficamos dormindo todos no mesmo quarto. No meio da noite, acordamos com uma visão assustadora: parecia haver um cachorro enorme e estranho dentro do quarto.<br><br>O medo coletivo nos fez gritar com toda a força dos nossos pulmões. Nossos pais, que estavam por perto, ouviram o desespero e voltaram correndo. Papai entrou no quarto decidido a nos defender de qualquer perigo, acendendo a luz e fazendo barulho.<br><br>Seja o que for que tenhamos visto — talvez uma sombra, um animal do mato ou fruto da nossa imaginação infantil — desapareceu na hora. Nossos pais nos acalmaram, fizeram uma oração para que tivéssemos bons sonhos e a paz voltou a reinar. Nunca mais tivemos tal visita, mas a história ficou marcada como um dos mistérios daquela casa.` 
            },
            
            { 
                id: 'fogo', 
                theme: 'sustos', 
                title: 'O Acidente na Cozinha', 
                content: `A vida na roça exigia que amadurecêssemos cedo. Aos 7 anos, eu já ajudava nas tarefas domésticas. Um dia, fui preparar o almoço. As panelas de ferro eram pesadas e esquentavam muito.<br><br>Num descuido, deixei a panela esquentar demais antes de colocar o óleo e o alho. A gordura quente reagiu e subiu uma labareda alta, respingando no meu braço esquerdo e causando queimaduras sérias.<br><br>A dor foi imensa. Longe de hospitais e farmácias, minha mãe usou o que conhecia da sabedoria popular: remédios caseiros e curativos com folhas de bananeira para aliviar o ardor. Foi um período difícil, de muito choro e aprendizado sobre a fragilidade da gente.` 
            },
            
            { 
                id: 'adeus', 
                theme: 'licoes', 
                title: 'Adeus ao Sertão', 
                content: `Minha recuperação era lenta, e minha tia, que morava na cidade, veio nos visitar. Ao ver meu estado, ela foi firme:<br>— Não posso deixá-la aqui sofrendo. Vou levá-la para Governador Valadares, onde há médicos e tratamento.<br><br>Meus pais ficaram com o coração apertado, mas sabiam que era o melhor para mim. Foi assim que, aos 7 anos, me preparei para deixar o meu "matão bravo".<br><br>A despedida foi banhada em lágrimas, mas também em expectativa. Caminhamos até a estrada principal para pegar o ônibus — que chamávamos de "auto". Para mim, entrar naquele veículo foi como entrar numa nave espacial. Era o começo de uma nova etapa, longe do ninho, rumo ao desconhecido.` 
            },
            
            { 
                id: 'resplendor', 
                theme: 'licoes', 
                title: 'A Cidade e o Trem de Ferro', 
                content: `A primeira parada foi na cidade de Resplendor. O nome fazia jus à beleza do lugar. Eu, uma menina acostumada com riachos, fiquei boquiaberta ao ver o Rio Doce, imenso e caudaloso.<br><br>Atravessamos o rio de canoa e passamos a noite num hotel. Da janela, vi o sol nascer refletido nas águas, uma cena que guardo até hoje como uma pintura na memória. Tomamos café da manhã "de cidade", com pão fresco e manteiga, um luxo para quem vinha da roça.<br><br>Mas a maior surpresa ainda estava por vir: o trem de ferro. Quando aquela máquina gigante chegou apitando e soltando fumaça, eu tremi nas bases. Segurei firme na mão da minha tia.<br>— Não tenha medo — ela disse sorrindo. — É só o trem.<br><br>Entramos no vagão cheio de gente. Tímida, abaixei a cabeça, envergonhada com tanta novidade, e assim segui até chegarmos ao nosso destino final.` 
            },
            
            { 
                id: 'cidade', 
                theme: 'licoes', 
                title: 'Luzes da Cidade Grande', 
                content: `Governador Valadares era um mundo à parte. Prédios altos, ruas movimentadas e muitas pessoas desconhecidas. Eu andava olhando para trás, desconfiada e fascinada ao mesmo tempo. Minha tia tentava me ensinar a etiqueta da cidade: "Não aponte o dedo, menina!", dizia ela quando eu me espantava com a altura das construções.<br><br>Meu braço ainda doía, e o tratamento na farmácia era difícil. Lembro-me de chorar muito durante os curativos, mas minha tia foi uma verdadeira mãe para mim naquele período, cuidando de mim com paciência e carinho.<br><br>Aos poucos, fui me acostumando. A casa da tia era diferente, tinha confortos que eu desconhecia, mas a saudade da roça ainda apertava no peito. Eu estava descobrindo que o mundo era muito maior do que o quintal da minha casa.` 
            },
            
            { 
                id: 'gatos', 
                theme: 'licoes', 
                title: 'Gatos, Charretes e Descobertas', 
                content: `Depois de curada, voltei a ser criança. A cidade tinha seus próprios "bichos". Os gatos da vizinhança faziam um barulho danado à noite, brigando nos telhados, algo que eu achava engraçadíssimo e muito diferente do silêncio do campo.<br><br>Minha tia me levava para passear de charrete — o "táxi" da época, puxado por cavalos. Eu me sentia uma rainha naquelas carruagens coloridas. Um dia, chegamos à praça central e vi uma igreja imensa, enfeitada para o Natal. Do alto da torre, músicas natalinas ecoavam pela cidade. Mesmo sem saber ler direito ainda, aprendi poesias da época que recito até hoje.<br><br>Foi ali, na cidade, que aprendi as letras. Minha tia me alfabetizou em casa, com paciência. Também aprendi a fazer pirulitos para vender na porta de casa. "Olha o pirulito!", eu gritava, orgulhosa do meu pequeno comércio.<br><br>Perto dali, o Rio Doce corria majestoso aos pés do Pico da Ibituruna. Hoje, vejo prédios modernos onde antes eu brincava, mas as memórias daquela menina sertaneja descobrindo a cidade grande permanecem intactas.` 
            },
            
            { 
                id: 'argentino', 
                theme: 'licoes', 
                title: 'O Menino Viajante', 
                content: `Voltando às memórias do Vale Verde... Certa vez, vimos um menino caminhando sozinho pela estrada poeirenta. Ele parecia cansado e falava com um sotaque diferente.<br>— Sou argentino — disse ele. — Estou com fome.<br><br>Minha mãe, com seu coração enorme, acolheu o menino. Ofereceu banho quente, roupas limpas e uma mesa farta com café, batata-doce e biscoitos. Ele comeu em silêncio, mas seus olhos mostravam gratidão.<br><br>Depois, ele nos contou sua história triste. Havia fugido de casa após um desentendimento grave com o pai, num momento de desespero e medo. Ele carregava uma culpa imensa e uma solidão profunda, vagando de lugar em lugar, buscando quem o aceitasse.<br><br>Minha mãe ouviu tudo com compaixão, sem julgar. Ela olhou nos olhos dele e disse palavras de conforto: "Deus conhece o seu coração e a sua dor, meu filho. Você não está sozinho no mundo".` 
            },
            
            { 
                id: 'acao', 
                theme: 'licoes', 
                title: 'Seguindo Viagem', 
                content: `Preparamos uma sacola com alimentos e roupas para a jornada dele. Convidamos o menino para ficar conosco, para encontrar paz na nossa família e na nossa fé. Dissemos a ele que, em nossa casa, a tristeza dava lugar à esperança.<br><br>Apesar do convite, ele preferiu seguir seu caminho, talvez em busca do seu próprio destino. Vimos ele sumir na curva da estrada, mas ficou em nós a certeza de que havíamos feito o que estava ao nosso alcance: oferecer amor e dignidade a quem precisava.` 
            },
            
            { 
                id: 'anjo', 
                theme: 'licoes', 
                title: 'Sonhos de Criança', 
                content: `As manhãs na fazenda eram mágicas, especialmente em dezembro, quando a chuva deixava tudo mais verde. O momento do café da manhã era sagrado: mesa cheia de quitandas mineiras e a família reunida.<br><br>Nessas conversas matinais, minha mãe falava sobre esperança e sobre um mundo melhor. A imaginação de criança voava longe nessas horas. Eu ficava tão envolvida com aquelas histórias de paz e beleza que, às vezes, parecia ver as nuvens tomarem formas incríveis no céu.<br><br>Lembro-me de um dia olhar para o alto e, na minha inocência e fé de menina, imaginar ver um anjo anunciando boas novas. Corri para contar à mamãe. Ela sorriu, entendeu a pureza do meu coração e disse: "É bom sonhar com coisas bonitas, minha filha. Isso mantém a esperança viva dentro da gente". Eram dias em que o céu parecia estar muito mais perto da terra.` 
            },
            
            { 
                id: 'fragmentos', 
                theme: 'final', 
                title: 'Fragmentos de Memória', 
                content: `<strong>Pedro Rita:</strong> Um vizinho bondoso da nossa infância. Sua fazenda era ponto de encontro, e suas filhas enchiam o rio de alegria enquanto lavavam roupas e cantavam.<br><br><strong>A Menina da Porteira:</strong> Naquela vendinha à beira da estrada, morava a pequena Maria. Com seus 6 anos, ela passava as tardes pendurada na porteira, observando a boiada passar e sonhando com o mundo além das montanhas.` 
            },
            
            { 
                id: 'poemas', 
                theme: 'final', 
                title: 'Versos do Coração', 
                content: `<blockquote style="border-left: 4px solid rgba(124,45,18,0.5); padding-left: 1rem; font-style: italic; color: #57534e; margin-bottom: 1.5rem;">Caminhei por estradas longas,<br>buscando sentido e paz.<br>Encontrei no amor divino<br>o refúgio que me satisfaz.<br>Não sou mais quem eu era,<br>o tempo me transformou.<br>Mas guardo a fé de menina,<br>que a vida me ensinou.</blockquote><blockquote style="border-left: 4px solid rgba(124,45,18,0.5); padding-left: 1rem; font-style: italic; color: #57534e;">Está escrito na vida e no tempo:<br>"Ama teu próximo de coração."<br>Que a bondade seja o guia,<br>e o afeto, a nossa canção.<br><br>Onde mora a verdadeira alegria?<br>Não no ouro ou na posição.<br>Mas no gesto simples de ajuda,<br>e na paz de um bom coração.</blockquote>` 
            }
        ];

        let currentPage = 0;
        const totalPages = stories.length;
        const bookContainer = document.getElementById('book');
        const progressBar = document.getElementById('progress');
        
        let isDragging = false;
        let isScrolling = false;
        let startX = 0;
        let startY = 0;
        let currentDragPage = null;
        let currentDragDirection = null; 

        function initBook() {
            bookContainer.innerHTML = '';

            stories.forEach((story, index) => {
                const page = document.createElement('div');
                page.className = 'page';
                page.id = `page-${index}`;
                
                // Z-Index reverso
                page.style.zIndex = totalPages - index; 

                // Conteúdo
                let contentHTML = '';
                let innerContent = '';

                if (story.type === 'cover') {
                    // CAPA NOVA E ESTILIZADA
                    innerContent = `
                        <div class="cover-content cover-bg">
                            <h1 class="font-fancy cover-title">Gecy Maria</h1>
                            
                            <!-- Ornamento SVG Clássico (Sem Emoji) -->
                            <div class="cover-ornament">
                                <svg width="140" height="40" viewBox="0 0 140 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M70 35C50 35 40 25 20 25C10 25 5 30 0 35M70 35C90 35 100 25 120 25C130 25 135 30 140 35M70 5C50 5 40 15 20 15C10 15 5 10 0 5M70 5C90 5 100 15 120 15C130 15 135 10 140 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                    <circle cx="70" cy="20" r="4" fill="currentColor"/>
                                </svg>
                            </div>

                            <h2 class="cover-subtitle">Autobiografia</h2>
                            <p style="margin-top: auto; color: var(--accent-light); font-size: 0.875rem; opacity: 0.8;">Arraste para abrir</p>
                        </div>
                    `;
                    contentHTML = `<div class="page-front page-front-bg">${innerContent}<div class="page-fold-shadow"></div></div>`;
                } else if (story.type === 'index') {
                    let indexLinks = stories.slice(2).map((s, i) => 
                        `<li onclick="goToPage(${i + 2})" class="index-item">
                            <span style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap; padding-right: 1rem;">${s.title}</span> 
                            <span class="page-badge">${i+1}</span>
                         </li>`
                    ).join('');
                    
                    innerContent = `
                        <h2 class="story-title" style="text-align: center; border-bottom: 2px solid rgba(124, 45, 18, 0.2); padding-bottom: 1rem;">Índice</h2>
                        <ul class="index-list">
                            ${indexLinks}
                        </ul>
                    `;
                    contentHTML = `<div class="page-front page-front-bg"><div class="content-scroll">${innerContent}</div><div class="page-fold-shadow"></div></div>`;
                } else {
                    innerContent = `
                        <h2 class="font-sans story-title">${story.title}</h2>
                        <div class="content-scroll">
                            ${story.content}
                        </div>
                        <div class="page-number">Página ${index - 1}</div>
                    `;
                    contentHTML = `<div class="page-front page-front-bg"><div class="content-scroll" style="height: 100%; overflow-y: auto;">${innerContent}</div><div class="page-fold-shadow"></div></div>`;
                }

                const backHTML = `
                    <div class="page-back">
                        <div style="opacity: 0.1; color: #78716c; font-size: 4rem; font-family: serif; user-select: none;">GM</div>
                        <div class="page-fold-shadow"></div>
                    </div>
                `;

                page.innerHTML = contentHTML + backHTML;
                page.addEventListener('dragstart', e => e.preventDefault());
                bookContainer.appendChild(page);
            });

            updateButtons();
            updateVisiblePages();
            setupInteractiveDrag();
        }

        // Função de memória para Mobile
        function updateVisiblePages() {
            const isMobile = window.innerWidth < 768;
            for (let i = 0; i < totalPages; i++) {
                const p = document.getElementById(`page-${i}`);
                if (!p) continue;

                // Mobile: range apertado (1 atrás, 1 frente)
                // Desktop: tudo visível (se aguentar) ou range maior
                const range = isMobile ? 1 : 2;

                if (Math.abs(currentPage - i) <= range) {
                    p.style.display = 'block';
                } else {
                    p.style.display = 'none';
                }
            }
        }

        function updateButtons() {
            const btnPrev = document.getElementById('btn-prev');
            const btnNext = document.getElementById('btn-next');
            const progress = (currentPage / (totalPages - 1)) * 100;
            progressBar.style.width = `${progress}%`;
            btnPrev.classList.toggle('btn-disabled', currentPage === 0);
            btnNext.classList.toggle('btn-disabled', currentPage >= totalPages - 1);
        }

        function downloadBook() {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'GecyMaria_Livro.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function finishFlip(targetIndex) {
            currentPage = targetIndex;
            updateButtons();
            
            // Reativa páginas para animação
            updateVisiblePages();

            for (let i = 0; i < totalPages; i++) {
                const p = document.getElementById(`page-${i}`);
                if (!p) continue;
                
                p.style.transform = '';
                p.classList.remove('grabbing');
                p.classList.add('page-transition'); 

                if (i < currentPage) {
                    p.style.transform = 'rotateY(-180deg)';
                    p.style.zIndex = i; 
                } else {
                    p.style.transform = 'rotateY(0deg)';
                    p.style.zIndex = totalPages - i;
                }

                // Limpa sombras
                const shadows = p.querySelectorAll('.page-fold-shadow');
                shadows.forEach(s => s.style.background = 'none');
            }

            setTimeout(() => {
                document.querySelectorAll('.page').forEach(p => p.classList.remove('page-transition'));
                updateVisiblePages(); 
            }, 600);
        }

        function setupInteractiveDrag() {
            const scene = document.getElementById('scene-container');
            const startEvents = ['mousedown', 'touchstart'];
            const moveEvents = ['mousemove', 'touchmove'];
            const endEvents = ['mouseup', 'touchend', 'mouseleave'];

            function getX(e) { return e.type.includes('mouse') ? e.pageX : e.touches[0].pageX; }
            function getY(e) { return e.type.includes('mouse') ? e.pageY : e.touches[0].pageY; }

            function onStart(e) {
                if (e.target.closest('button')) return;

                isDragging = false;
                isScrolling = false;
                startX = getX(e);
                startY = getY(e);
                
                const width = window.innerWidth;
                const isRightSide = startX > width / 2;

                if (isRightSide && currentPage < totalPages) {
                    currentDragPage = document.getElementById(`page-${currentPage}`);
                    currentDragDirection = 'next';
                } else if (!isRightSide && currentPage > 0) {
                    currentDragPage = document.getElementById(`page-${currentPage - 1}`);
                    currentDragDirection = 'prev';
                } else {
                    currentDragPage = null;
                }

                if (currentDragPage) {
                    currentDragPage.style.display = 'block'; 
                }
            }

            function onMove(e) {
                if (isScrolling) return;

                const x = getX(e);
                const y = getY(e);
                const deltaX = x - startX;
                const deltaY = y - startY;

                if (!isDragging) {
                    if (Math.abs(deltaY) > Math.abs(deltaX) && Math.abs(deltaY) > 5) {
                        isScrolling = true;
                        return;
                    } 
                    else if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 5) {
                        isDragging = true;
                        if (currentDragPage) currentDragPage.classList.add('grabbing');
                    } else {
                        return; 
                    }
                }

                if (isDragging && currentDragPage) {
                    if (e.cancelable) e.preventDefault();

                    const screenW = window.innerWidth;
                    const bookW = screenW > 768 ? screenW / 2 : screenW;

                    let rotation = 0;
                    let shadowStyle = '';

                    if (currentDragDirection === 'next') {
                        // 0 a -180
                        const progress = Math.min(0, Math.max(-bookW, deltaX)) / bookW; // 0 a -1
                        rotation = progress * 180;
                        
                        // Ilusão de Dobra (Esticar)
                        // Quanto mais perto do meio (-90deg), mais escuro
                        const intensity = Math.sin(Math.abs(progress) * Math.PI); 
                        const shadowPos = Math.abs(progress) * 100;
                        shadowStyle = `linear-gradient(90deg, transparent, rgba(0,0,0,${intensity * 0.3}) ${shadowPos}%, transparent)`;

                    } else {
                        // -180 a 0
                        const progress = Math.min(bookW, Math.max(0, deltaX)) / bookW; // 0 a 1
                        rotation = -180 + (progress * 180);
                        
                        const intensity = Math.sin(progress * Math.PI);
                        const shadowPos = 100 - (progress * 100);
                        shadowStyle = `linear-gradient(90deg, transparent, rgba(0,0,0,${intensity * 0.3}) ${shadowPos}%, transparent)`;
                    }

                    currentDragPage.style.transform = `rotateY(${rotation}deg)`;
                    
                    // Aplica a sombra de dobra dinâmica
                    const shadows = currentDragPage.querySelectorAll('.page-fold-shadow');
                    shadows.forEach(s => s.style.background = shadowStyle);
                }
            }

            function onEnd(e) {
                if (!isDragging) return;
                isDragging = false;
                
                if (!currentDragPage) return;

                currentDragPage.classList.remove('grabbing');
                currentDragPage.classList.add('page-transition'); 

                const currentTransform = currentDragPage.style.transform;
                const rotationMatch = currentTransform.match(/rotateY\(([-\d.]+)deg\)/);
                let currentRot = rotationMatch ? parseFloat(rotationMatch[1]) : 0;

                if (currentDragDirection === 'next') {
                    if (currentRot < -30) {
                        finishFlip(currentPage + 1);
                    } else {
                        // Reverte
                        currentDragPage.style.transform = 'rotateY(0deg)';
                        const shadows = currentDragPage.querySelectorAll('.page-fold-shadow');
                        shadows.forEach(s => s.style.background = 'none');
                    }
                } else {
                    if (currentRot > -150) {
                        finishFlip(currentPage - 1);
                    } else {
                        // Reverte
                        currentDragPage.style.transform = 'rotateY(-180deg)';
                        const shadows = currentDragPage.querySelectorAll('.page-fold-shadow');
                        shadows.forEach(s => s.style.background = 'none');
                    }
                }
                currentDragPage = null;
            }

            startEvents.forEach(evt => scene.addEventListener(evt, onStart, { passive: false }));
            moveEvents.forEach(evt => window.addEventListener(evt, onMove, { passive: false }));
            endEvents.forEach(evt => window.addEventListener(evt, onEnd));
        }

        function nextPage() {
            if (currentPage < totalPages - 1) finishFlip(currentPage + 1);
        }
        function prevPage() {
            if (currentPage > 0) finishFlip(currentPage - 1);
        }
        window.goToPage = function(target) {
            finishFlip(target);
        }

        document.getElementById('btn-next').addEventListener('click', nextPage);
        document.getElementById('btn-prev').addEventListener('click', prevPage);
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') nextPage();
            if (e.key === 'ArrowLeft') prevPage();
        });

        document.addEventListener('DOMContentLoaded', initBook);

    </script>
</body>
</html>
